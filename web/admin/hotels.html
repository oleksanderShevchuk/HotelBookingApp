<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin - Hotels</title>
    <link rel="stylesheet" href="/css/styles.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="/js/presentation/pages/adminHotelsPage.entry.js" defer></script>
    <script type="module" src="/js/presentation/components/modal.entry.js" defer></script>
    <script type="module" src="/js/presentation/components/adminNav.entry.js" defer></script>
    <script src="https://unpkg.com/@alpinejs/teleport" defer></script>
    <script src="https://unpkg.com/@alpinejs/focus" defer></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-gray-100" x-data="adminHotelsPage()" x-init="init()">

    <nav class="admin-nav" x-data="adminNav()" x-init="init(); guardAdmin()">
        <div class="nav-wrap">
            <div class="flex items-center gap-3">
                <a href="/index.html" class="brand text-xl font-bold text-blue-700">üè® HotelBooking</a>
                <a x-show="user" href="/profile.html" class="admin-tab">My bookings</a>

                <div class="admin-tabs">
                    <a href="/admin/hotels.html"
                       :class="['admin-tab', {active: isActive('/admin/hotels.html')}]"
                       @click.prevent="requireAdmin($event, '/admin/hotels.html')">Hotels</a>

                    <a href="/admin/rooms.html"
                       :class="['admin-tab', {active: isActive('/admin/rooms.html')}]"
                       @click.prevent="requireAdmin($event, '/admin/rooms.html')">Rooms</a>

                    <a href="/admin/bookings.html"
                       :class="['admin-tab', {active: isActive('/admin/bookings.html')}]"
                       @click.prevent="requireAdmin($event, '/admin/bookings.html')">Bookings</a>

                </div>
            </div>

            <div class="flex items-center gap-3">
                <template x-if="user">
                    <div class="flex items-center gap-3">
                        <span x-text="user.email" class="text-gray-700"></span>
                        <button @click="logout()" class="btn-danger">Logout</button>
                    </div>
                </template>

                <template x-if="!user">
                    <div class="flex items-center gap-3">
                        <a href="/login.html" class="btn">Login</a>
                        <a href="/register.html" class="btn">Register</a>
                    </div>
                </template>
            </div>
        </div>
    </nav>

    <div class="page container mx-auto">
        <div class="flex items-center justify-between mb-4">
            <h1 class="text-3xl font-bold">Hotels</h1>
            <button @click="openAdd()" class="btn-primary">+ Add Hotel</button>
        </div>

        <div class="table-wrap">
            <table class="table table-fixed w-full">
                <thead>
                    <tr>
                        <th class="w-3/12">Name</th>
                        <th class="w-2/12">City</th>
                        <th class="w-4/12">Address</th>
                        <th class="w-2/12">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <template x-for="hotel in hotels" :key="hotel.id">
                        <tr>
                            <td class="truncate" :title="hotel.name" x-text="hotel.name"></td>
                            <td class="truncate" :title="hotel.city" x-text="hotel.city"></td>
                            <td class="truncate" :title="hotel.address" x-text="hotel.address"></td>
                            <td class="whitespace-nowrap">
                                <button class="btn-edit" @click="openEdit(hotel)">Edit</button>
                                <button class="btn-danger" @click="deleteHotel(hotel.id)">Delete</button>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Model -->
    <div x-data="modalComp()" x-show="open" x-cloak class="modal-overlay">
        <div class="modal-card" @click.stop>
            <h2 class="modal-title" x-text="title"></h2>

            <div class="space-y-2">
                <label class="label">Name</label>
                <input x-model="data.name" class="input" placeholder="Name">
                <p class="error" x-text="errors.name"></p>

                <label class="label">City</label>
                <input x-model="data.city" class="input" placeholder="City">
                <p class="error" x-text="errors.city"></p>

                <label class="label">Address</label>
                <input x-model="data.address" class="input" placeholder="Address">

                <label class="label">Description</label>
                <textarea x-model="data.description" class="input" placeholder="Description"></textarea>

                <p class="error" x-text="errors._common"></p>
            </div>

            <div class="mt-5 flex gap-2 justify-end">
                <button class="btn" @click="open=false">Cancel</button>
                <button class="btn-primary"
                        :class="{'opacity-60 pointer-events-none': saving}"
                        @click="save({ required: ['name','city','address'] })">
                    <span x-show="!saving">Save</span>
                    <span x-show="saving">Saving‚Ä¶</span>
                </button>
            </div>
        </div>
    </div>
</body>
</html>
